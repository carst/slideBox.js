function createState(e,t,i){return{path:e,hash:t,title:i}}function getState(){var e=window.location.pathname,t=window.location.search.slice(1),i=window.location.hash.substring(1),o=document.title,s=createState(e,i,o);return debug&&(console.log("indexPath: "+e),console.log("hash: "+i),console.log("indexTitle: "+o)),s}function createPath(e,t){var i=e.split("/"),o=i.length;return e+t+"/"}function loadState(e){var t=e.path,i=e.title;debug&&(console.log("itemPath = "+t),console.log("itemTitle = "+i)),""!==t&&history.pushState("",i,t),document.title=i}function resetState(){document.location.hash="",history.pushState("",indexTitle,indexPath),document.title=indexTitle}function setScroll(e){var t=e.parent();e.hasClass("box-has-content")?(t.addClass("allow-scroll"),debug&&console.log("hello there")):t.removeClass("allow-scroll")}function setSlideBg(e,t){function i(e){var i,o=e.data("src"),s=e.data("srcFull"),n=e.data("srcFullSl");return mobile&&void 0!==n?i=n:void 0!==s?i=s:t&&void 0!==o?i=o:e.hasClass("lazyload")||(i=e.attr("src")),i}function o(e){r=e.hasClass("slide")?e:e.parent()}function s(){r.css("background-image","url("+d+")").addClass("has-bg"),l.removeClass("loading").addClass("bg-set"),a=!0,r.is("img")&&l.attr("src",slideBoxCm.imageDir+"blank.gif")}var n=e.is("img"),l=n?e:e.children("img"),a=l.hasClass("bg-set"),d,r,c=new Image,u=!1;return l.length>0&&!a&&(debug&&console.log(l),d=i(l),o(l),void 0!==d&&(l.addClass("loading"),c.onload=s(),c.src=d)),a}function loadSlideBgs(e){var t={slide:".slide, .load-bg"},e=void 0===e?$(".box-active"):e;e.find(t.slide).each(function(){setSlideBg($(this))})}function initSlides(e){function t(){function e(){var e,t;u&&(w=new Promise(function(i){window.onYouTubeIframeAPIReady=i,e=document.createElement("script"),e.src="https://www.youtube.com/iframe_api",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})),v&&(e=document.createElement("script"),e.src="https://player.vimeo.com/api/player.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t))}function t(e){var t=e.attr("id");console.log("Pause video: "+t),e.is("video")?e.get(0).pause():e.hasClass("video-yt")?g[t].pauseVideo():e.hasClass("video-vimeo")&&g[t].pause()}function i(e){t($(e.target))}function o(e){var t=e.attr("id");e.hasClass("video-yt")?(C.debug&&console.log("Adding YT Player "+t),g[t]=new YT.Player(t)):e.hasClass("video-vimeo")&&(C.debug&&console.log("Adding Vimeo Player "+t),g[t]=new Vimeo.Player(e.get(0))),e.on("pauseVideo",i)}function s(e){var t=e.target,i=$(t),s=i.is("video"),n=i.hasClass("video-yt"),l=i.hasClass("video-vimeo"),a,d,r,c=i.closest(C.slideBox),u=b.index(c),v=z[u];(n||l)&&(a=t.cloneNode(!0),d=t.parentNode,a.src=t.getAttribute("data-src"),a.classList.remove("lazyload","lazyloading"),a.classList.add("lazyloaded"),d.insertBefore(a,t),t.remove(),r=$(a),z[u].videos=c.find("video, .video-yt, .video-vimeo"),n?w.then(function(e){o(r)}):o(l?r:r))}var l=b.find("video"),a=b.find(".video-yt"),r=b.find(".video-vimeo"),c=l.length>0,u=a.length>0,v=r.length>0,g={};l.on("pauseVideo",i),e(),b.each(function(){var e=$(this),t=e.closest(C.container),i=b.index(e),o=e.find(C.slide),s=e.find("video, .video-yt, .video-vimeo"),l=o.length,a=e.find(".slide-active"),r=a.length>0,c=e.data("carousel")||e.hasClass("box-carousel")||e.hasClass("slide-box-carousel"),u=e.data("loop")||e.hasClass("auto-loop")||t.hasClass("auto-loop"),v=e.data("interval")?e.data("interval"):C.interval,g=t.find(".controls"),f=g.find(".prev"),m=g.find(".next"),h=g.find(".close"),p=e.find(".pager"),x=p.find("a");r||(a=o.eq(0)),1===l&&m.addClass("disabled"),z[i]={slides:o,videos:s,slideCount:l,slideActive:a.length>0?a:o.eq(0),pos:a.length>0?o.index(a):0,isCarousel:c,controls:{el:g,prev:f,next:m,close:h},pager:{el:p,a:x}},c&&(n(i),a.addClass("slide-active"),z[i].prevSlide.addClass("slide-prev"),z[i].nextSlide.addClass("slide-next"),u&&l>1&&setInterval(function(){d(e,"next")},v))}),C.debug&&console.log(z),document.addEventListener("lazybeforeunveil",function(e){var t=e.target,i=$(t),o,s=i.data("src");o=setSlideBg(i,!0),e.preventDefault()}),(u||v)&&document.addEventListener("lazybeforeunveil",s)}function i(){x=$(".box-active")}function o(e){e.addClass("box-active"),i(),loadSlideBgs()}function s(e){return $slideActive=e.find(".slide-active"),$slideActive}function n(e){function t(){r=s.pos+A.prev,c=s.pos+A.next,s.prevSlide=r>=0?n.eq(r):n.eq(l),s.nextSlide=c<=l?n.eq(c):n.eq(0),1===s.slideCount&&(s.nextSlide=$(),s.prevSlide=$())}var i=void 0!==e?e:b.index(x),o=void 0!==i?b.eq(i):x,s=z[i],n=s.slides,l=s.slideCount-1,a=o.find(".slide-active"),d=a.length>0,r,c;s.pos=d?n.index(a):0,t(),C.debug&&console.log("slideIndex after load {\n\tactive : \t"+s.pos+"\t\t #"+a.attr("id")+"\n\tprev : \t\t"+r+"\t\t #"+s.prevSlide.attr("id")+"\n\tnext : \t\t"+c+"\t\t #"+s.nextSlide.attr("id")+"\n}"),z[i]=s}function l(e){var t=b.eq(e),i=z[e],o=i.controls.el,s=i.controls.prev,n=i.controls.next,l=i.pager.el;i.pager.a.removeClass("active pg-item-active").eq(i.pos).addClass("pg-item-active"),0===i.prevSlide.length?s.addClass("disabled"):s.removeClass("disabled"),0===i.nextSlide.length?n.addClass("disabled"):n.removeClass("disabled")}function a(e){C.debug&&console.log("loadSlide : "+e.attr("id"));var t=e.closest(C.slideBox),i=b.index(t),o=z[i],s=e.attr("id"),a,d,r=createPath(B.path,s),c=t.find(".list-item-title").text(),u=createState(r,c);o.slides.removeClass("playing"),$("#slide-copy").remove(),o.videos.trigger("pauseVideo"),e.hasClass("slide-active")?e.removeClass("slide-active"):(o.slides.removeClass("slide-active"),e.addClass("slide-active"),$(document).trigger("slideChanged"),n(i),C.setPath&&loadState(u),a=o.nextSlide.hasClass("slide-prev"),d=o.prevSlide.hasClass("slide-next"),o.slides.removeClass("slide-prev slide-next prev-to-next next-to-prev"),a?(console.log("nextIsPrev"),o.nextSlide.clone().addClass("prev-out").attr("id","slide-copy").insertBefore(o.nextSlide),o.nextSlide.addClass("prev-to-next")):o.nextSlide.addClass("slide-next"),d?(console.log("prevIsNext"),o.prevSlide.clone().insertBefore(o.prevSlide).addClass("prev-out").attr("id","slide-copy"),o.prevSlide.addClass("next-to-prev")):o.prevSlide.addClass("slide-prev")),l(i),setScroll(t)}function d(e,t){var i=void 0!==t?t:"";e.each(function(){function e(){var e=s.slideCount-1,t=""!==i?r+A[i]:n.index($slide),l;return t>e&&(t=0),t<0&&(t=e),t!==r?(r=t,z[o].pos=r,l=n.eq(t)):l=!1,C.debug,l}var t=$(this),o=b.index(t),s=z[o],n=s.slides,l=s.slideActive,d=t.hasClass("box-browse")||t.hasClass("box-zoomed")||s.isCarousel,r=s.pos,c;C.debug&&console.log("\nboxIndex: "+o+", "+s.slideCount+" slides,\ndir : "+i+", allowChange: "+d),d&&(c=e())&&a(c)})}function r(e){var t=y.length>0,i,o,s;return"object"==typeof e?(e.preventDefault(),i=$(e.target),o=i.closest(C.slideBox),!o.length>0&&(s=i.closest(C.container),o=s.find(C.slideBox))):o=t?y:x,C.debug,o}function c(e){d(r(e),"prev")}function u(e){d(r(e),"next")}function v(e){b.eq(e).hasClass("box-zoomed")&&(z[e].controls.prev.removeClass("widget-hide"),z[e].controls.next.removeClass("widget-hide"),z[e].controls.close.removeClass("widget-hide"))}function g(e){var t,i,s,n;void 0!==e?($(document).trigger("zoomIn"),C.debug&&console.log("Zoom In"),t=e.closest(C.slideBox),i=b.index(t),s=z[i],o(t),t.addClass("box-zoomed"),y=t,s.slides.addClass("slide-detail"),$.scrollLock(!0),e.hasClass("slide-active")||a(e),v(i)):y.length>0&&(C.debug&&console.log("Zoom Out"),t=y,n=t.find(".slide-active"),C.debug&&console.log("slideActive:"+n.attr("class")),$(document).trigger("zoomOut"),i=b.index(t),s=z[i],t.removeClass("box-zoomed"),y=$(),s.slides.removeClass("slide-detail"),s.isCarousel||s.slides.removeClass("slide-active slide-prev slide-next"),s.videos.trigger("pauseVideo"),$.scrollLock(!1),v(i),C.setPath&&loadState(B),$(document).trigger("zoomedOut"))}function f(e){var t=e.find(C.slide).eq(0);o(e),g(t)}function m(){""!==hash&&(C.debug&&console.log("hash: "+hash),f($("#"+hash)))}function h(){b.on("slideBoxChange",function(e){var t=$(e.target);C.debug&&console.log("slideBoxChange event triggered"),o(t),n()}).on("prevSlide",c).on("nextSlide",u),S.on("toggleZoom",function(e){g($(e.target))}),$(document).on("slideChanged",function(){C.debug&&console.log("slideChanged event triggered")}),C.slideBoxClick?$(document).on("click",".slide-box:not(.box-zoomed)",function(e){C.debug&&console.log("\nslideBox clicked"),f($(this))}):$(document).on("click",".slide:not(a,.slide-detail,.slide.playing)",function(e){e.stopPropagation(),C.debug&&console.log("\nSlide clicked"),g($(this))}),$(document).on("click",".slide-detail:not(.slide.playing)",function(e){var t=$(this),i=t.parents(".slide-box"),o=t.data("archiveUrl");e.stopPropagation(),C.debug&&console.log("\nDetail slide clicked:"+t),g()}).on("click",".controls .prev",c).on("click",".controls .next",u).on("swiperight",c).on("swipeleft",u).on("click",".controls .close",function(e){e.preventDefault(),g()}).on("click",".number, .pg-item",function(e){var t=$(this),i=t.closest(C.slideBox),o=b.index(i),s=z[o].slides,n=z[o].pager.a.index(t),l=s.eq(n);e.preventDefault(),C.debug&&console.log("item clicked "+parseInt(n+1)),l.hasClass("slide-active")||a(l)}).on("keyup",function(e){switch(e.keyCode){case 27:g();break;case 37:c();break;case 39:u();break}})}if(slideBoxCm.initialized)debug&&console.log("initSlides: slideBox was already initialized.");else{var p={container:".slide-box",slideBox:".slide-box",slide:".slide",slideBoxClick:!1,setPath:!1,wrapSlides:!1,loopSlides:!1,interval:5e3,debug:debug},C="object"==typeof e?e:p,b=$(C.slideBox),x=$(),y=$(),z=[],S=b.find(C.slide),w,B=getState(),A={prev:-1,next:1};C.debug&&console.log(C)}!slideBoxCm.initialized&&b.length>0&&(t(),h(),i(),slideBoxCm.initialized=!0,C.debug&&console.log("initSlides: slideBox was initialized."))}var debug=void 0!==debug&&debug,mobile=void 0!==mobile&&mobile;$.scrollLock=function e(){function t(){s||(s=$("body")),n=s.css("overflow"),s.css("overflow","hidden"),o=!0}function i(){s.css("overflow",n),o=!1}var o=!1,s,n;return function e(s){arguments.length?s?t():i():o?i():t()}}();var slideBoxCm={initialized:!1,imageDir:"undefined"!=typeof imageDir?imageDir:"./assets/images/"};$(function(){initSlides()}),function(e,t){var i=t(e,e.document);e.lazySizes=i,"object"==typeof module&&module.exports&&(module.exports=i)}(window,function e(t,i){"use strict";if(i.getElementsByClassName){var o,s,n=i.documentElement,l=t.Date,a=t.HTMLPictureElement,d="addEventListener",r="getAttribute",c=t[d],u=t.setTimeout,v=t.requestAnimationFrame||u,g=t.requestIdleCallback,f=/^picture$/i,m=["load","error","lazyincluded","_lazyloaded"],h={},p=Array.prototype.forEach,C=function(e,t){return h[t]||(h[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),h[t].test(e[r]("class")||"")&&h[t]},b=function(e,t){C(e,t)||e.setAttribute("class",(e[r]("class")||"").trim()+" "+t)},x=function(e,t){var i;(i=C(e,t))&&e.setAttribute("class",(e[r]("class")||"").replace(i," "))},y=function(e,t,i){var o=i?d:"removeEventListener";i&&y(e,t),m.forEach(function(i){e[o](i,t)})},z=function(e,t,s,n,l){var a=i.createEvent("CustomEvent");return s||(s={}),s.instance=o,a.initCustomEvent(t,!n,!l,s),e.dispatchEvent(a),a},S=function(e,i){var o;!a&&(o=t.picturefill||s.pf)?o({reevaluate:!0,elements:[e]}):i&&i.src&&(e.src=i.src)},w=function(e,t){return(getComputedStyle(e,null)||{})[t]},B=function(e,t,i){for(i=i||e.offsetWidth;i<s.minSize&&t&&!e._lazysizesWidth;)i=t.offsetWidth,t=t.parentNode;return i},A=function(){var e,t,o=[],s=[],n=o,l=function(){var i=n;for(n=o.length?s:o,e=!0,t=!1;i.length;)i.shift()();e=!1},a=function(o,s){e&&!s?o.apply(this,arguments):(n.push(o),t||(t=!0,(i.hidden?u:v)(l)))};return a._lsFlush=l,a}(),k=function(e,t){return t?function(){A(e)}:function(){var t=this,i=arguments;A(function(){e.apply(t,i)})}},E=function(e){var t,i=0,o=s.throttleDelay,n=s.ricTimeout,a=function(){t=!1,i=l.now(),e()},d=g&&n>49?function(){g(a,{timeout:n}),n!==s.ricTimeout&&(n=s.ricTimeout)}:k(function(){u(a)},!0);return function(e){var s;(e=!0===e)&&(n=33),t||(t=!0,s=o-(l.now()-i),s<0&&(s=0),e||s<9?d():u(d,s))}},P=function(e){var t,i,o=99,s=function(){t=null,e()},n=function(){var e=l.now()-i;e<99?u(n,99-e):(g||s)(s)};return function(){i=l.now(),t||(t=u(n,99))}};!function(){var e,i={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};s=t.lazySizesConfig||t.lazysizesConfig||{};for(e in i)e in s||(s[e]=i[e]);t.lazySizesConfig=s,u(function(){s.init&&q()})}();var N=function(){var e,a,v,g,m,h,B,N,q,D,M,_,I,L,W=/^img$/i,F=/^iframe$/i,O="onscroll"in t&&!/glebot/.test(navigator.userAgent),R=0,V=0,H=0,j=-1,Y=function(e){H--,e&&e.target&&y(e.target,Y),(!e||H<0||!e.target)&&(H=0)},Z=function(e,t){var o,s=e,l="hidden"==w(i.body,"visibility")||"hidden"!=w(e,"visibility");for(N-=t,M+=t,q-=t,D+=t;l&&(s=s.offsetParent)&&s!=i.body&&s!=n;)(l=(w(s,"opacity")||1)>0)&&"visible"!=w(s,"overflow")&&(o=s.getBoundingClientRect(),l=D>o.left&&q<o.right&&M>o.top-1&&N<o.bottom+1);return l},U=function(){var t,l,d,c,u,v,f,m,p,C=o.elements;if((g=s.loadMode)&&H<8&&(t=C.length)){l=0,j++,null==I&&("expand"in s||(s.expand=n.clientHeight>500&&n.clientWidth>500?500:370),_=s.expand,I=_*s.expFactor),V<I&&H<1&&j>2&&g>2&&!i.hidden?(V=I,j=0):V=g>1&&j>1&&H<6?_:0;for(;l<t;l++)if(C[l]&&!C[l]._lazyRace)if(O)if((m=C[l][r]("data-expand"))&&(v=1*m)||(v=V),p!==v&&(h=innerWidth+v*L,B=innerHeight+v,f=-1*v,p=v),d=C[l].getBoundingClientRect(),(M=d.bottom)>=f&&(N=d.top)<=B&&(D=d.right)>=f*L&&(q=d.left)<=h&&(M||D||q||N)&&(s.loadHidden||"hidden"!=w(C[l],"visibility"))&&(a&&H<3&&!m&&(g<3||j<4)||Z(C[l],v))){if(ie(C[l]),u=!0,H>9)break}else!u&&a&&!c&&H<4&&j<4&&g>2&&(e[0]||s.preloadAfterLoad)&&(e[0]||!m&&(M||D||q||N||"auto"!=C[l][r](s.sizesAttr)))&&(c=e[0]||C[l]);else ie(C[l]);c&&!u&&ie(c)}},G=E(U),J=function(e){b(e.target,s.loadedClass),x(e.target,s.loadingClass),y(e.target,Q),z(e.target,"lazyloaded")},K=k(J),Q=function(e){K({target:e.target})},X=function(e,t){try{e.contentWindow.location.replace(t)}catch(i){e.src=t}},ee=function(e){var t,i=e[r](s.srcsetAttr);(t=s.customMedia[e[r]("data-media")||e[r]("media")])&&e.setAttribute("media",t),i&&e.setAttribute("srcset",i)},te=k(function(e,t,i,o,n){var l,a,d,c,g,m;(g=z(e,"lazybeforeunveil",t)).defaultPrevented||(o&&(i?b(e,s.autosizesClass):e.setAttribute("sizes",o)),a=e[r](s.srcsetAttr),l=e[r](s.srcAttr),n&&(d=e.parentNode,c=d&&f.test(d.nodeName||"")),m=t.firesLoad||"src"in e&&(a||l||c),g={target:e},m&&(y(e,Y,!0),clearTimeout(v),v=u(Y,2500),b(e,s.loadingClass),y(e,Q,!0)),c&&p.call(d.getElementsByTagName("source"),ee),a?e.setAttribute("srcset",a):l&&!c&&(F.test(e.nodeName)?X(e,l):e.src=l),n&&(a||c)&&S(e,{src:l})),e._lazyRace&&delete e._lazyRace,x(e,s.lazyClass),A(function(){(!m||e.complete&&e.naturalWidth>1)&&(m?Y(g):H--,J(g))},!0)}),ie=function(e){var t,i=W.test(e.nodeName),o=i&&(e[r](s.sizesAttr)||e[r]("sizes")),n="auto"==o;(!n&&a||!i||!e[r]("src")&&!e.srcset||e.complete||C(e,s.errorClass)||!C(e,s.lazyClass))&&(t=z(e,"lazyunveilread").detail,n&&T.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,H++,te(e,t,n,o,i))},oe=function(){if(!a){if(l.now()-m<999)return void u(oe,999);var e=P(function(){s.loadMode=3,G()});a=!0,s.loadMode=3,G(),c("scroll",function(){3==s.loadMode&&(s.loadMode=2),e()},!0)}};return{_:function(){m=l.now(),o.elements=i.getElementsByClassName(s.lazyClass),e=i.getElementsByClassName(s.lazyClass+" "+s.preloadClass),L=s.hFac,c("scroll",G,!0),c("resize",G,!0),t.MutationObserver?new MutationObserver(G).observe(n,{childList:!0,subtree:!0,attributes:!0}):(n[d]("DOMNodeInserted",G,!0),n[d]("DOMAttrModified",G,!0),setInterval(G,999)),c("hashchange",G,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){i[d](e,G,!0)}),/d$|^c/.test(i.readyState)?oe():(c("load",oe),i[d]("DOMContentLoaded",G),u(oe,2e4)),o.elements.length?(U(),A._lsFlush()):G()},checkElems:G,unveil:ie}}(),T=function(){var e,t=k(function(e,t,i,o){var s,n,l;if(e._lazysizesWidth=o,o+="px",e.setAttribute("sizes",o),f.test(t.nodeName||""))for(s=t.getElementsByTagName("source"),n=0,l=s.length;n<l;n++)s[n].setAttribute("sizes",o);i.detail.dataAttr||S(e,i.detail)}),o=function(e,i,o){var s,n=e.parentNode;n&&(o=B(e,n,o),s=z(e,"lazybeforesizes",{width:o,dataAttr:!!i}),s.defaultPrevented||(o=s.detail.width)&&o!==e._lazysizesWidth&&t(e,n,s,o))},n=function(){var t,i=e.length;if(i)for(t=0;t<i;t++)o(e[t])},l=P(n);return{_:function(){e=i.getElementsByClassName(s.autosizesClass),c("resize",l)},checkElems:l,updateElem:o}}(),q=function(){q.i||(q.i=!0,T._(),N._())};return o={cfg:s,autoSizer:T,loader:N,init:q,uP:S,aC:b,rC:x,hC:C,fire:z,gW:B,rAF:A}}});
//# sourceMappingURL=./slidebox-min.js.map