function createState(e,t,i){return{path:e,hash:t,title:i}}function getState(){var e=window.location.pathname,t=window.location.search.slice(1),i=window.location.hash.substring(1),o=document.title,n=createState(e,i,o);return debug&&(console.log("indexPath: "+e),console.log("hash: "+i),console.log("indexTitle: "+o)),n}function createPath(e,t){var i=e.split("/"),o=i.length;return e+t+"/"}function loadState(e){var t=e.path,i=e.title;debug&&(console.log("itemPath = "+t),console.log("itemTitle = "+i)),""!==t&&history.pushState("",i,t),document.title=i}function resetState(){document.location.hash="",history.pushState("",indexTitle,indexPath),document.title=indexTitle}function setScroll(e){var t=e.parent();e.hasClass("box-has-content")?(t.addClass("allow-scroll"),debug&&console.log("hello there")):t.removeClass("allow-scroll")}function setSlideBg(e,t){function i(e){var i,o=e.data("src"),n=e.data("srcFull"),s=e.data("srcFullSl");return mobile&&void 0!==s?i=s:void 0!==n?i=n:t&&void 0!==o?i=o:e.hasClass("lazyload")||(i=e.attr("src")),i}function o(){e.removeClass("loading").css("background-image","url("+a+")").addClass("has-bg"),e.is("img")&&s.attr("src",r+"blank.gif")}var n=!1,s=e.is("img")?e:e.children("img"),a,l=new Image,d=!1,r=void 0!==imgDirDefault?imgDirDefault:"images/";return e.is("a")&&(s=e.find("img")),s.length>0&&!e.hasClass("has-bg")&&void 0!==(a=i(s))&&(e.addClass("loading"),l.onload=o(),l.src=a,n=!0),n}function loadSlideBgs(e){var t={slide:".slide, .load-bg"},e=void 0===e?$(".box-active"):e;e.find(t.slide).each(function(){setSlideBg($(this))})}function initSlides(e){function t(){function t(){var e,t;u&&(S=new Promise(function(i){window.onYouTubeIframeAPIReady=i,e=document.createElement("script"),e.src="https://www.youtube.com/iframe_api",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})),g&&(e=document.createElement("script"),e.src="https://player.vimeo.com/api/player.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t))}function i(e){var t=e.attr("id");console.log("Pause video: "+t),e.is("video")?e.get(0).pause():e.hasClass("video-yt")?f[t].pauseVideo():e.hasClass("video-vimeo")&&f[t].pause()}function o(e){i($(e.target))}function n(t){var i=t.attr("id");t.hasClass("video-yt")?(e.debug&&console.log("Adding YT Player "+i),f[i]=new YT.Player(i)):t.hasClass("video-vimeo")&&(e.debug&&console.log("Adding Vimeo Player "+i),f[i]=new Vimeo.Player(t.get(0))),t.on("pauseVideo",o)}function s(t){var i=t.target,o=$(i),s=o.is("video"),a=o.hasClass("video-yt"),l=o.hasClass("video-vimeo"),d,r,c,u=o.closest(e.slideBox),g=b.index(u),f=x[g];(a||l)&&(d=i.cloneNode(!0),r=i.parentNode,d.src=i.getAttribute("data-src"),d.classList.remove("lazyload","lazyloading"),d.classList.add("lazyloaded"),r.insertBefore(d,i),i.remove(),c=$(d),x[g].videos=u.find("video, .video-yt, .video-vimeo"),a?S.then(function(e){n(c)}):n(l?c:c))}var a=b.find("video"),l=b.find(".video-yt"),r=b.find(".video-vimeo"),c=a.length>0,u=l.length>0,g=r.length>0,f={};a.on("pauseVideo",o),t(),b.each(function(){var t=$(this),i=t.closest(e.container),o=b.index(t),n=t.find(e.slide),s=t.find("video, .video-yt, .video-vimeo"),a=n.length,l=t.find(".slide-active"),r=l.length>0,c=t.data("loop")||t.hasClass("auto-loop")||i.hasClass("auto-loop"),u=t.data("interval")?t.data("interval"):e.interval,g=i.find(".controls"),f=g.find(".prev"),v=g.find(".next"),m=g.find(".close"),h=t.find(".pager"),p=h.find("a");r||(l=n.eq(0),l.addClass("slide-active")),1===a&&v.addClass("disabled"),x[o]={slides:n,videos:s,slideCount:a,slideActive:l.length>0?l:n.eq(0),pos:l.length>0?n.index(l):0,controls:{el:g,prev:f,next:v,close:m},pager:{el:h,a:p}},c&&a>1&&setInterval(function(){d(t,"next")},u)}),e.debug&&console.log(x),document.addEventListener("lazybeforeunveil",function(t){var i=t.target,o=$(i),n=o.closest(e.slide),s,a=o.data("src");s=setSlideBg(n,!0)}),(u||g)&&document.addEventListener("lazybeforeunveil",s)}function i(){C=$(".box-active")}function o(e){e.addClass("box-active"),i(),loadSlideBgs()}function n(e){return $slideActive=e.find(".slide-active"),$slideActive}function s(t){function i(){r=n.pos+A.prev,c=n.pos+A.next,n.prevSlide=r>=0?s.eq(r):s.eq(a),n.nextSlide=c<=a?s.eq(c):s.eq(0),1===n.slideCount&&(n.nextSlide=$(),n.prevSlide=$())}var t=void 0!==t?t:b.index(C),o=void 0!==t?b.eq(t):C,n=x[t],s=n.slides,a=n.slideCount-1,l=o.find(".slide-active"),d=l.length>0,r,c;n.pos=d?s.index(l):0,i(),e.debug&&console.log("slideIndex after load {\n\tactive : \t"+n.pos+"\t\t #"+l.attr("id")+"\n\tprev : \t\t"+r+"\t\t #"+n.prevSlide.attr("id")+"\n\tnext : \t\t"+c+"\t\t #"+n.nextSlide.attr("id")+"\n}"),x[t]=n}function a(e){var t=b.eq(e),i=x[e],o=i.controls.el,n=i.controls.prev,s=i.controls.next,a=i.pager.el;i.pager.a.removeClass("active pg-item-active").eq(i.pos).addClass("pg-item-active"),0===i.prevSlide.length?n.addClass("disabled"):n.removeClass("disabled"),0===i.nextSlide.length?s.addClass("disabled"):s.removeClass("disabled")}function l(t){e.debug&&console.log("loadSlide : "+t.attr("id"));var i=t.closest(e.slideBox),o=b.index(i),n=x[o],l=t.attr("id"),d=createPath(w.path,l),r=i.find(".list-item-title").text(),c=createState(d,r);n.slides.removeClass("slide-prev slide-next playing").not(t).removeClass("slide-active"),n.videos.trigger("pauseVideo"),t.hasClass("slide-active")?t.removeClass("slide-active"):(t.addClass("slide-active"),$(document).trigger("slideChanged"),s(o),e.setPath&&loadState(c),n.prevSlide.addClass("slide-prev"),n.nextSlide.addClass("slide-next")),a(o),setScroll(i)}function d(t,i){var i=void 0!==i?i:"";t.each(function(){function t(){var t=s.slideCount-1,o=""!==i?c+A[i]:a.index($slide),l;return o>t&&(o=0),o<0&&(o=t),o!==c?(c=o,x[n].pos=c,l=a.eq(o)):l=!1,e.debug,l}var o=$(this),n=b.index(o),s=x[n],a=s.slides,d=s.slideActive,r=o.hasClass("box-browse")||o.hasClass("box-zoomed")||o.hasClass("slide-box-carousel"),c=s.pos,u;e.debug&&console.log("\nboxIndex: "+n+", "+s.slideCount+" slides,\ndir : "+i+", allowChange: "+r),r&&(u=t())&&l(u)})}function r(t){var i=y.length>0,o,n,s;return"object"==typeof t?(t.preventDefault(),o=$(t.target),n=o.closest(e.slideBox),!n.length>0&&(s=o.closest(e.container),n=s.find(e.slideBox))):n=i?y:C,e.debug,n}function c(e){d(r(e),"prev")}function u(e){d(r(e),"next")}function g(e){b.eq(e).hasClass("box-zoomed")&&(x[e].controls.prev.removeClass("widget-hide"),x[e].controls.next.removeClass("widget-hide"),x[e].controls.close.removeClass("widget-hide"))}function f(t){var i,n,s,a;void 0!==t?($(document).trigger("zoomIn"),e.debug&&console.log("Zoom In"),i=t.closest(e.slideBox),n=b.index(i),s=x[n],o(i),i.addClass("box-zoomed"),y=i,s.slides.addClass("slide-detail"),$.scrollLock(!0),t.hasClass("slide-active")||l(t),g(n)):y.length>0&&(e.debug&&console.log("Zoom Out"),i=y,a=i.find(".slide-active"),e.debug&&console.log("slideActive:"+a.attr("class")),$(document).trigger("zoomOut"),n=b.index(i),s=x[n],i.removeClass("box-zoomed"),y=$(),s.slides.removeClass("slide-detail"),i.hasClass("slide-box-carousel")||s.slides.removeClass("slide-active slide-prev slide-next"),s.videos.trigger("pauseVideo"),$.scrollLock(!1),g(n),e.setPath&&loadState(w),$("html,body").animate({scrollTop:a.offset().top-60},0),$(document).trigger("zoomedOut"))}function v(t){var i=t.find(e.slide).eq(0);o(t),f(i)}function m(){""!==hash&&(e.debug&&console.log("hash: "+hash),v($("#"+hash)))}function h(){b.on("slideBoxChange",function(t){var i=$(t.target);e.debug&&console.log("slideBoxChange event triggered"),o(i),s()}).on("prevSlide",c).on("nextSlide",u),z.on("toggleZoom",function(e){f($(e.target))}),$(document).on("slideChanged",function(){e.debug&&console.log("slideChanged event triggered")}),e.slideBoxClick?$(document).on("click",".slide-box:not(.box-zoomed)",function(t){e.debug&&console.log("\nslideBox clicked"),v($(this))}):$(document).on("click",".slide:not(.slide-detail,.slide.playing)",function(t){t.stopPropagation(),e.debug&&console.log("\nSlide clicked"),f($(this))}),$(document).on("click",".slide-detail:not(.slide.playing)",function(t){var i=$(this),o=i.parents(".slide-box"),n=i.data("archiveUrl");t.stopPropagation(),e.debug&&console.log("\nDetail slide clicked:"+i),f()}).on("click",".controls .prev",c).on("click",".controls .next",u).on("swiperight",c).on("swipeleft",u).on("click",".controls .close",function(e){e.preventDefault(),f()}).on("click",".number, .pg-item",function(t){var i=$(this),o=i.closest(e.slideBox),n=b.index(o),s=x[n].slides,a=x[n].pager.a.index(i),d=s.eq(a);t.preventDefault(),e.debug&&console.log("item clicked "+parseInt(a+1)),d.hasClass("slide-active")||l(d)}).on("keyup",function(e){switch(e.keyCode){case 27:f();break;case 37:c();break;case 39:u();break}})}var p={container:".slide-box",slideBox:".slide-box",slide:".slide",slideBoxClick:!1,setPath:!1,wrapSlides:!1,loopSlides:!1,interval:5e3,debug:debug},e="object"==typeof e?e:p,b=$(e.slideBox),C=$(),y=$(),x=[],z=b.find(e.slide),S,w=getState(),A={prev:-1,next:1};e.debug&&console.log(e),b.length>0&&(t(),h(),i(),loadSlideBgs(b))}var debug=void 0!==debug&&debug,mobile=void 0!==mobile&&mobile,imgDirDefault=void 0!==imgDirDefault?imgDirDefault:"assets/images/";$.scrollLock=function e(){function t(){n||(n=$("body")),s=n.css("overflow"),n.css("overflow","hidden"),o=!0}function i(){n.css("overflow",s),o=!1}var o=!1,n,s;return function e(n){arguments.length?n?t():i():o?i():t()}}();var slideBoxCm={};!function(e,t){var i=t(e,e.document);e.lazySizes=i,"object"==typeof module&&module.exports&&(module.exports=i)}(window,function e(t,i){"use strict";if(i.getElementsByClassName){var o,n,s=i.documentElement,a=t.Date,l=t.HTMLPictureElement,d="addEventListener",r="getAttribute",c=t[d],u=t.setTimeout,g=t.requestAnimationFrame||u,f=t.requestIdleCallback,v=/^picture$/i,m=["load","error","lazyincluded","_lazyloaded"],h={},p=Array.prototype.forEach,b=function(e,t){return h[t]||(h[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),h[t].test(e[r]("class")||"")&&h[t]},C=function(e,t){b(e,t)||e.setAttribute("class",(e[r]("class")||"").trim()+" "+t)},y=function(e,t){var i;(i=b(e,t))&&e.setAttribute("class",(e[r]("class")||"").replace(i," "))},x=function(e,t,i){var o=i?d:"removeEventListener";i&&x(e,t),m.forEach(function(i){e[o](i,t)})},z=function(e,t,n,s,a){var l=i.createEvent("CustomEvent");return n||(n={}),n.instance=o,l.initCustomEvent(t,!s,!a,n),e.dispatchEvent(l),l},S=function(e,i){var o;!l&&(o=t.picturefill||n.pf)?o({reevaluate:!0,elements:[e]}):i&&i.src&&(e.src=i.src)},w=function(e,t){return(getComputedStyle(e,null)||{})[t]},A=function(e,t,i){for(i=i||e.offsetWidth;i<n.minSize&&t&&!e._lazysizesWidth;)i=t.offsetWidth,t=t.parentNode;return i},B=function(){var e,t,o=[],n=[],s=o,a=function(){var i=s;for(s=o.length?n:o,e=!0,t=!1;i.length;)i.shift()();e=!1},l=function(o,n){e&&!n?o.apply(this,arguments):(s.push(o),t||(t=!0,(i.hidden?u:g)(a)))};return l._lsFlush=a,l}(),k=function(e,t){return t?function(){B(e)}:function(){var t=this,i=arguments;B(function(){e.apply(t,i)})}},E=function(e){var t,i=0,o=n.throttleDelay,s=n.ricTimeout,l=function(){t=!1,i=a.now(),e()},d=f&&s>49?function(){f(l,{timeout:s}),s!==n.ricTimeout&&(s=n.ricTimeout)}:k(function(){u(l)},!0);return function(e){var n;(e=!0===e)&&(s=33),t||(t=!0,n=o-(a.now()-i),n<0&&(n=0),e||n<9?d():u(d,n))}},P=function(e){var t,i,o=99,n=function(){t=null,e()},s=function(){var e=a.now()-i;e<99?u(s,99-e):(f||n)(n)};return function(){i=a.now(),t||(t=u(s,99))}};!function(){var e,i={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};n=t.lazySizesConfig||t.lazysizesConfig||{};for(e in i)e in n||(n[e]=i[e]);t.lazySizesConfig=n,u(function(){n.init&&T()})}();var D=function(){var e,l,g,f,m,h,A,D,T,q,M,_,L,I,W=/^img$/i,F=/^iframe$/i,O="onscroll"in t&&!/glebot/.test(navigator.userAgent),R=0,V=0,H=0,j=-1,Y=function(e){H--,e&&e.target&&x(e.target,Y),(!e||H<0||!e.target)&&(H=0)},Z=function(e,t){var o,n=e,a="hidden"==w(i.body,"visibility")||"hidden"!=w(e,"visibility");for(D-=t,M+=t,T-=t,q+=t;a&&(n=n.offsetParent)&&n!=i.body&&n!=s;)(a=(w(n,"opacity")||1)>0)&&"visible"!=w(n,"overflow")&&(o=n.getBoundingClientRect(),a=q>o.left&&T<o.right&&M>o.top-1&&D<o.bottom+1);return a},U=function(){var t,a,d,c,u,g,v,m,p,b=o.elements;if((f=n.loadMode)&&H<8&&(t=b.length)){a=0,j++,null==L&&("expand"in n||(n.expand=s.clientHeight>500&&s.clientWidth>500?500:370),_=n.expand,L=_*n.expFactor),V<L&&H<1&&j>2&&f>2&&!i.hidden?(V=L,j=0):V=f>1&&j>1&&H<6?_:0;for(;a<t;a++)if(b[a]&&!b[a]._lazyRace)if(O)if((m=b[a][r]("data-expand"))&&(g=1*m)||(g=V),p!==g&&(h=innerWidth+g*I,A=innerHeight+g,v=-1*g,p=g),d=b[a].getBoundingClientRect(),(M=d.bottom)>=v&&(D=d.top)<=A&&(q=d.right)>=v*I&&(T=d.left)<=h&&(M||q||T||D)&&(n.loadHidden||"hidden"!=w(b[a],"visibility"))&&(l&&H<3&&!m&&(f<3||j<4)||Z(b[a],g))){if(ie(b[a]),u=!0,H>9)break}else!u&&l&&!c&&H<4&&j<4&&f>2&&(e[0]||n.preloadAfterLoad)&&(e[0]||!m&&(M||q||T||D||"auto"!=b[a][r](n.sizesAttr)))&&(c=e[0]||b[a]);else ie(b[a]);c&&!u&&ie(c)}},G=E(U),J=function(e){C(e.target,n.loadedClass),y(e.target,n.loadingClass),x(e.target,Q),z(e.target,"lazyloaded")},K=k(J),Q=function(e){K({target:e.target})},X=function(e,t){try{e.contentWindow.location.replace(t)}catch(i){e.src=t}},ee=function(e){var t,i=e[r](n.srcsetAttr);(t=n.customMedia[e[r]("data-media")||e[r]("media")])&&e.setAttribute("media",t),i&&e.setAttribute("srcset",i)},te=k(function(e,t,i,o,s){var a,l,d,c,f,m;(f=z(e,"lazybeforeunveil",t)).defaultPrevented||(o&&(i?C(e,n.autosizesClass):e.setAttribute("sizes",o)),l=e[r](n.srcsetAttr),a=e[r](n.srcAttr),s&&(d=e.parentNode,c=d&&v.test(d.nodeName||"")),m=t.firesLoad||"src"in e&&(l||a||c),f={target:e},m&&(x(e,Y,!0),clearTimeout(g),g=u(Y,2500),C(e,n.loadingClass),x(e,Q,!0)),c&&p.call(d.getElementsByTagName("source"),ee),l?e.setAttribute("srcset",l):a&&!c&&(F.test(e.nodeName)?X(e,a):e.src=a),s&&(l||c)&&S(e,{src:a})),e._lazyRace&&delete e._lazyRace,y(e,n.lazyClass),B(function(){(!m||e.complete&&e.naturalWidth>1)&&(m?Y(f):H--,J(f))},!0)}),ie=function(e){var t,i=W.test(e.nodeName),o=i&&(e[r](n.sizesAttr)||e[r]("sizes")),s="auto"==o;(!s&&l||!i||!e[r]("src")&&!e.srcset||e.complete||b(e,n.errorClass)||!b(e,n.lazyClass))&&(t=z(e,"lazyunveilread").detail,s&&N.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,H++,te(e,t,s,o,i))},oe=function(){if(!l){if(a.now()-m<999)return void u(oe,999);var e=P(function(){n.loadMode=3,G()});l=!0,n.loadMode=3,G(),c("scroll",function(){3==n.loadMode&&(n.loadMode=2),e()},!0)}};return{_:function(){m=a.now(),o.elements=i.getElementsByClassName(n.lazyClass),e=i.getElementsByClassName(n.lazyClass+" "+n.preloadClass),I=n.hFac,c("scroll",G,!0),c("resize",G,!0),t.MutationObserver?new MutationObserver(G).observe(s,{childList:!0,subtree:!0,attributes:!0}):(s[d]("DOMNodeInserted",G,!0),s[d]("DOMAttrModified",G,!0),setInterval(G,999)),c("hashchange",G,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){i[d](e,G,!0)}),/d$|^c/.test(i.readyState)?oe():(c("load",oe),i[d]("DOMContentLoaded",G),u(oe,2e4)),o.elements.length?(U(),B._lsFlush()):G()},checkElems:G,unveil:ie}}(),N=function(){var e,t=k(function(e,t,i,o){var n,s,a;if(e._lazysizesWidth=o,o+="px",e.setAttribute("sizes",o),v.test(t.nodeName||""))for(n=t.getElementsByTagName("source"),s=0,a=n.length;s<a;s++)n[s].setAttribute("sizes",o);i.detail.dataAttr||S(e,i.detail)}),o=function(e,i,o){var n,s=e.parentNode;s&&(o=A(e,s,o),n=z(e,"lazybeforesizes",{width:o,dataAttr:!!i}),n.defaultPrevented||(o=n.detail.width)&&o!==e._lazysizesWidth&&t(e,s,n,o))},s=function(){var t,i=e.length;if(i)for(t=0;t<i;t++)o(e[t])},a=P(s);return{_:function(){e=i.getElementsByClassName(n.autosizesClass),c("resize",a)},checkElems:a,updateElem:o}}(),T=function(){T.i||(T.i=!0,N._(),D._())};return o={cfg:n,autoSizer:N,loader:D,init:T,uP:S,aC:C,rC:y,hC:b,fire:z,gW:A,rAF:B}}});
//# sourceMappingURL=./slidebox-min.js.map