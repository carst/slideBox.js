function createState(e,t,i){return{path:e,hash:t,title:i}}function getState(){var e=window.location.pathname,t=window.location.search.slice(1),i=window.location.hash.substring(1),o=document.title,n=createState(e,i,o);return debug&&(console.log("indexPath: "+e),console.log("hash: "+i),console.log("indexTitle: "+o)),n}function createPath(e,t){var i=e.split("/"),o=i.length;return e+t+"/"}function loadState(e){var t=e.path,i=e.title;debug&&(console.log("itemPath = "+t),console.log("itemTitle = "+i)),""!==t&&history.pushState("",i,t),document.title=i}function resetState(){document.location.hash="",history.pushState("",indexTitle,indexPath),document.title=indexTitle}function setScroll(e){var t=e.parent();e.hasClass("box-has-content")?(t.addClass("allow-scroll"),debug&&console.log("hello there")):t.removeClass("allow-scroll")}function setSlideBg(e,t){function i(e){var i,o=e.data("src"),n=e.data("srcFull"),s=e.data("srcFullSl");return mobile&&void 0!==s?i=s:void 0!==n?i=n:t&&void 0!==o?i=o:e.hasClass("lazyload")||(i=e.attr("src")),i}function o(){e.removeClass("loading").css("background-image","url("+a+")").addClass("has-bg"),e.is("img")&&s.attr("src",r+"blank.gif")}var n=!1,s=e.is("img")?e:e.children("img"),a,l=new Image,d=!1,r=void 0!==imgDirDefault?imgDirDefault:"images/";return e.is("a")&&(s=e.find("img")),s.length>0&&!e.hasClass("has-bg")&&void 0!==(a=i(s))&&(e.addClass("loading"),l.onload=o(),l.src=a,n=!0),n}function loadSlideBgs(e){var t={slide:".slide, .load-bg"},e=void 0===e?$(".box-active"):e;e.find(t.slide).each(function(){setSlideBg($(this))})}function initSlides(e){function t(){function t(){var e,t;u&&(S=new Promise(function(i){window.onYouTubeIframeAPIReady=i,e=document.createElement("script"),e.src="https://www.youtube.com/iframe_api",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})),f&&(e=document.createElement("script"),e.src="https://player.vimeo.com/api/player.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t))}function i(e){var t=e.attr("id");console.log("Pause video: "+t),e.is("video")?e.get(0).pause():e.hasClass("video-yt")?g[t].pauseVideo():e.hasClass("video-vimeo")&&g[t].pause()}function o(e){i($(e.target))}function n(t){var i=t.attr("id");t.hasClass("video-yt")?(e.debug&&console.log("Adding YT Player "+i),g[i]=new YT.Player(i)):t.hasClass("video-vimeo")&&(e.debug&&console.log("Adding Vimeo Player "+i),g[i]=new Vimeo.Player(t.get(0))),t.on("pauseVideo",o)}function s(t){var i=t.target,o=$(i),s=o.is("video"),a=o.hasClass("video-yt"),l=o.hasClass("video-vimeo"),d,r,c,u=o.closest(e.slideBox),f=b.index(u),g=y[f];(a||l)&&(d=i.cloneNode(!0),r=i.parentNode,d.src=i.getAttribute("data-src"),d.classList.remove("lazyload","lazyloading"),d.classList.add("lazyloaded"),r.insertBefore(d,i),i.remove(),c=$(d),y[f].videos=u.find("video, .video-yt, .video-vimeo"),a?S.then(function(e){n(c)}):n(l?c:c))}var a=b.find("video"),l=b.find(".video-yt"),r=b.find(".video-vimeo"),c=a.length>0,u=l.length>0,f=r.length>0,g={};a.on("pauseVideo",o),t(),b.each(function(){var t=$(this),i=t.closest(e.container),o=b.index(t),n=t.find(e.slide),s=t.find("video, .video-yt, .video-vimeo"),a=n.length,l=t.find(".slide-active"),r=l.length>0,c=t.data("loop")||t.hasClass("auto-loop")||i.hasClass("auto-loop"),u=t.data("interval")?t.data("interval"):e.interval,f=i.find(".controls"),g=f.find(".prev"),v=f.find(".next"),h=f.find(".close"),m=t.find(".pager"),p=m.find("a");r||(l=n.eq(0),l.addClass("slide-active")),1===a&&v.addClass("disabled"),y[o]={slides:n,videos:s,slideCount:a,slideActive:l.length>0?l:n.eq(0),pos:l.length>0?n.index(l):0,controls:{el:f,prev:g,next:v,close:h},pager:{el:m,a:p}},c&&a>1&&setInterval(function(){d(t,"next")},u)}),e.debug&&console.log(y),document.addEventListener("lazybeforeunveil",function(t){var i=t.target,o=$(i),n=o.closest(e.slide),s,a=o.data("src");s=setSlideBg(n,!0)}),(u||f)&&document.addEventListener("lazybeforeunveil",s)}function i(){C=$(".box-active")}function o(e){e.addClass("box-active"),i(),loadSlideBgs()}function n(e){return $slideActive=e.find(".slide-active"),$slideActive}function s(t){function i(){r=n.pos+A.prev,c=n.pos+A.next,n.prevSlide=r>=0?s.eq(r):s.eq(a),n.nextSlide=c<=a?s.eq(c):s.eq(0),1===n.slideCount&&(n.nextSlide=$(),n.prevSlide=$())}var t=void 0!==t?t:b.index(C),o=void 0!==t?b.eq(t):C,n=y[t],s=n.slides,a=n.slideCount-1,l=o.find(".slide-active"),d=l.length>0,r,c;n.pos=d?s.index(l):0,i(),e.debug&&console.log("slideIndex after load {\n\tactive : \t"+n.pos+"\t\t #"+l.attr("id")+"\n\tprev : \t\t"+r+"\t\t #"+n.prevSlide.attr("id")+"\n\tnext : \t\t"+c+"\t\t #"+n.nextSlide.attr("id")+"\n}"),y[t]=n}function a(e){var t=b.eq(e),i=y[e],o=i.controls.el,n=i.controls.prev,s=i.controls.next,a=i.pager.el;i.pager.a.removeClass("active").eq(i.pos).addClass("active"),0===i.prevSlide.length?n.addClass("disabled"):n.removeClass("disabled"),0===i.nextSlide.length?s.addClass("disabled"):s.removeClass("disabled")}function l(t){e.debug&&console.log("loadSlide : "+t.attr("id"));var i=t.closest(e.slideBox),o=b.index(i),n=y[o],l=t.attr("id"),d=createPath(w.path,l),r=i.find(".list-item-title").text(),c=createState(d,r);n.slides.removeClass("slide-prev slide-next playing").not(t).removeClass("slide-active"),n.videos.trigger("pauseVideo"),t.hasClass("slide-active")?t.removeClass("slide-active"):(t.addClass("slide-active"),$(document).trigger("slideChanged"),s(o),e.setPath&&loadState(c),n.prevSlide.addClass("slide-prev"),n.nextSlide.addClass("slide-next")),a(o),setScroll(i)}function d(t,i){var i=void 0!==i?i:"";t.each(function(){function t(){var t=s.slideCount-1,o=""!==i?c+A[i]:a.index($slide),l;return o>t&&(o=0),o<0&&(o=t),o!==c?(c=o,y[n].pos=c,l=a.eq(o)):l=!1,e.debug,l}var o=$(this),n=b.index(o),s=y[n],a=s.slides,d=s.slideActive,r=o.hasClass("box-browse")||o.hasClass("box-zoomed")||o.hasClass("slide-box-carousel"),c=s.pos,u;e.debug&&console.log("\nboxIndex: "+n+", "+s.slideCount+" slides,\ndir : "+i+", allowChange: "+r),r&&(u=t())&&l(u)})}function r(t){var i=x.length>0,o,n,s;return"object"==typeof t?(t.preventDefault(),o=$(t.target),n=o.closest(e.slideBox),!n.length>0&&(s=o.closest(e.container),n=s.find(e.slideBox))):n=i?x:C,e.debug,n}function c(e){d(r(e),"prev")}function u(e){d(r(e),"next")}function f(e){b.eq(e).hasClass("box-zoomed")&&(y[e].controls.prev.removeClass("widget-hide"),y[e].controls.next.removeClass("widget-hide"),y[e].controls.close.removeClass("widget-hide"))}function g(t){var i,n,s,a;void 0!==t?($(document).trigger("zoomIn"),e.debug&&console.log("Zoom In"),i=t.closest(e.slideBox),n=b.index(i),s=y[n],o(i),i.addClass("box-zoomed"),x=i,s.slides.addClass("slide-detail"),$.scrollLock(!0),t.hasClass("slide-active")||l(t),f(n)):x.length>0&&(e.debug&&console.log("Zoom Out"),i=x,a=i.find(".slide-active"),e.debug&&console.log("slideActive:"+a.attr("class")),$(document).trigger("zoomOut"),n=b.index(i),s=y[n],i.removeClass("box-zoomed"),x=$(),s.slides.removeClass("slide-detail"),i.hasClass("slide-box-carousel")||s.slides.removeClass("slide-active slide-prev slide-next"),s.videos.trigger("pauseVideo"),$.scrollLock(!1),f(n),e.setPath&&loadState(w),$("html,body").animate({scrollTop:a.offset().top-60},0),$(document).trigger("zoomedOut"))}function v(t){var i=t.find(e.slide).eq(0);o(t),g(i)}function h(){""!==hash&&(e.debug&&console.log("hash: "+hash),v($("#"+hash)))}function m(){b.on("slideBoxChange",function(t){var i=$(t.target);e.debug&&console.log("slideBoxChange event triggered"),o(i),s()}).on("prevSlide",c).on("nextSlide",u),z.on("toggleZoom",function(e){g($(e.target))}),$(document).on("slideChanged",function(){e.debug&&console.log("slideChanged event triggered")}),e.slideBoxClick?$(document).on("click",".slide-box:not(.box-zoomed)",function(t){e.debug&&console.log("\nslideBox clicked"),v($(this))}):$(document).on("click",".slide:not(.slide-detail,.slide.playing)",function(t){t.stopPropagation(),e.debug&&console.log("\nSlide clicked"),g($(this))}),$(document).on("click",".slide-detail:not(.slide.playing)",function(t){var i=$(this),o=i.parents(".slide-box"),n=i.data("archiveUrl");t.stopPropagation(),e.debug&&console.log("\nDetail slide clicked:"+i),g()}).on("click",".controls .prev",c).on("click",".controls .next",u).on("swiperight",c).on("swipeleft",u).on("click",".controls .close",function(e){e.preventDefault(),g()}).on("click",".number",function(t){var i=$(this),o=i.closest(e.slideBox),n=b.index(o),s=y[n].slides,a=y[n].pager.a.index(i),d=s.eq(a);t.preventDefault(),e.debug&&console.log("number clicked "+parseInt(a+1)),d.hasClass("slide-active")||l(d)}).on("keyup",function(e){switch(e.keyCode){case 27:g();break;case 37:c();break;case 39:u();break}})}var p={container:".slide-box",slideBox:".slide-box",slide:".slide",slideBoxClick:!1,setPath:!1,wrapSlides:!1,loopSlides:!1,interval:5e3,debug:debug},e="object"==typeof e?e:p,b=$(e.slideBox),C=$(),x=$(),y=[],z=b.find(e.slide),S,w=getState(),A={prev:-1,next:1};e.debug&&console.log(e),b.length>0&&(t(),m(),i(),loadSlideBgs(b))}var debug=void 0!==debug&&debug,mobile=void 0!==mobile&&mobile,imgDirDefault=void 0!==imgDirDefault?imgDirDefault:"assets/images/";$.scrollLock=function e(){function t(){n||(n=$("body")),s=n.css("overflow"),n.css("overflow","hidden"),o=!0}function i(){n.css("overflow",s),o=!1}var o=!1,n,s;return function e(n){arguments.length?n?t():i():o?i():t()}}();var slideBoxCm={};!function(e,t){var i=t(e,e.document);e.lazySizes=i,"object"==typeof module&&module.exports&&(module.exports=i)}(window,function e(t,i){"use strict";if(i.getElementsByClassName){var o,n=i.documentElement,s=t.Date,a=t.HTMLPictureElement,l="addEventListener",d="getAttribute",r=t[l],c=t.setTimeout,u=t.requestAnimationFrame||c,f=t.requestIdleCallback,g=/^picture$/i,v=["load","error","lazyincluded","_lazyloaded"],h={},m=Array.prototype.forEach,p=function(e,t){return h[t]||(h[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),h[t].test(e[d]("class")||"")&&h[t]},b=function(e,t){p(e,t)||e.setAttribute("class",(e[d]("class")||"").trim()+" "+t)},C=function(e,t){var i;(i=p(e,t))&&e.setAttribute("class",(e[d]("class")||"").replace(i," "))},x=function(e,t,i){var o=i?l:"removeEventListener";i&&x(e,t),v.forEach(function(i){e[o](i,t)})},y=function(e,t,o,n,s){var a=i.createEvent("CustomEvent");return a.initCustomEvent(t,!n,!s,o||{}),e.dispatchEvent(a),a},z=function(e,i){var n;!a&&(n=t.picturefill||o.pf)?n({reevaluate:!0,elements:[e]}):i&&i.src&&(e.src=i.src)},S=function(e,t){return(getComputedStyle(e,null)||{})[t]},w=function(e,t,i){for(i=i||e.offsetWidth;i<o.minSize&&t&&!e._lazysizesWidth;)i=t.offsetWidth,t=t.parentNode;return i},A=function(){var e,t,o=[],n=[],s=o,a=function(){var i=s;for(s=o.length?n:o,e=!0,t=!1;i.length;)i.shift()();e=!1},l=function(o,n){e&&!n?o.apply(this,arguments):(s.push(o),t||(t=!0,(i.hidden?c:u)(a)))};return l._lsFlush=a,l}(),B=function(e,t){return t?function(){A(e)}:function(){var t=this,i=arguments;A(function(){e.apply(t,i)})}},k=function(e){var t,i=0,o=125,n=666,a=666,l=function(){t=!1,i=s.now(),e()},d=f?function(){f(l,{timeout:a}),666!==a&&(a=666)}:B(function(){c(l)},!0);return function(e){var o;(e=!0===e)&&(a=44),t||(t=!0,o=125-(s.now()-i),o<0&&(o=0),e||o<9&&f?d():c(d,o))}},E=function(e){var t,i,o=99,n=function(){t=null,e()},a=function(){var e=s.now()-i;e<99?c(a,99-e):(f||n)(n)};return function(){i=s.now(),t||(t=c(a,99))}},N=function(){var e,a,u,f,v,h,w,N,D,q,M,T,_,L,I,W=/^img$/i,F=/^iframe$/i,O="onscroll"in t&&!/glebot/.test(navigator.userAgent),R=0,V=0,j=0,H=-1,Y=function(e){j--,e&&e.target&&x(e.target,Y),(!e||j<0||!e.target)&&(j=0)},Z=function(e,t){var o,s=e,a="hidden"==S(i.body,"visibility")||"hidden"!=S(e,"visibility");for(D-=t,T+=t,q-=t,M+=t;a&&(s=s.offsetParent)&&s!=i.body&&s!=n;)(a=(S(s,"opacity")||1)>0)&&"visible"!=S(s,"overflow")&&(o=s.getBoundingClientRect(),a=M>o.left&&q<o.right&&T>o.top-1&&D<o.bottom+1);return a},U=function(){var t,s,l,r,c,f,g,h,m;if((v=o.loadMode)&&j<8&&(t=e.length)){s=0,H++,null==L&&("expand"in o||(o.expand=n.clientHeight>500&&n.clientWidth>500?500:370),_=o.expand,L=_*o.expFactor),V<L&&j<1&&H>2&&v>2&&!i.hidden?(V=L,H=0):V=v>1&&H>1&&j<6?_:0;for(;s<t;s++)if(e[s]&&!e[s]._lazyRace)if(O)if((h=e[s][d]("data-expand"))&&(f=1*h)||(f=V),m!==f&&(w=innerWidth+f*I,N=innerHeight+f,g=-1*f,m=f),l=e[s].getBoundingClientRect(),(T=l.bottom)>=g&&(D=l.top)<=N&&(M=l.right)>=g*I&&(q=l.left)<=w&&(T||M||q||D)&&(u&&j<3&&!h&&(v<3||H<4)||Z(e[s],f))){if(ie(e[s]),c=!0,j>9)break}else!c&&u&&!r&&j<4&&H<4&&v>2&&(a[0]||o.preloadAfterLoad)&&(a[0]||!h&&(T||M||q||D||"auto"!=e[s][d](o.sizesAttr)))&&(r=a[0]||e[s]);else ie(e[s]);r&&!c&&ie(r)}},G=k(U),J=function(e){b(e.target,o.loadedClass),C(e.target,o.loadingClass),x(e.target,Q)},K=B(J),Q=function(e){K({target:e.target})},X=function(e,t){try{e.contentWindow.location.replace(t)}catch(i){e.src=t}},ee=function(e){var t,i,n=e[d](o.srcsetAttr);(t=o.customMedia[e[d]("data-media")||e[d]("media")])&&e.setAttribute("media",t),n&&e.setAttribute("srcset",n),t&&(i=e.parentNode,i.insertBefore(e.cloneNode(),e),i.removeChild(e))},te=B(function(e,t,i,n,s){var a,l,r,u,v,h;(v=y(e,"lazybeforeunveil",t)).defaultPrevented||(n&&(i?b(e,o.autosizesClass):e.setAttribute("sizes",n)),l=e[d](o.srcsetAttr),a=e[d](o.srcAttr),s&&(r=e.parentNode,u=r&&g.test(r.nodeName||"")),h=t.firesLoad||"src"in e&&(l||a||u),v={target:e},h&&(x(e,Y,!0),clearTimeout(f),f=c(Y,2500),b(e,o.loadingClass),x(e,Q,!0)),u&&m.call(r.getElementsByTagName("source"),ee),l?e.setAttribute("srcset",l):a&&!u&&(F.test(e.nodeName)?X(e,a):e.src=a),(l||u)&&z(e,{src:a})),e._lazyRace&&delete e._lazyRace,C(e,o.lazyClass),A(function(){(!h||e.complete&&e.naturalWidth>1)&&(h?Y(v):j--,J(v))},!0)}),ie=function(e){var t,i=W.test(e.nodeName),n=i&&(e[d](o.sizesAttr)||e[d]("sizes")),s="auto"==n;(!s&&u||!i||!e.src&&!e.srcset||e.complete||p(e,o.errorClass))&&(t=y(e,"lazyunveilread").detail,s&&P.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,j++,te(e,t,s,n,i))},oe=function(){if(!u){if(s.now()-h<999)return void c(oe,999);var e=E(function(){o.loadMode=3,G()});u=!0,o.loadMode=3,G(),r("scroll",function(){3==o.loadMode&&(o.loadMode=2),e()},!0)}};return{_:function(){h=s.now(),e=i.getElementsByClassName(o.lazyClass),a=i.getElementsByClassName(o.lazyClass+" "+o.preloadClass),I=o.hFac,r("scroll",G,!0),r("resize",G,!0),t.MutationObserver?new MutationObserver(G).observe(n,{childList:!0,subtree:!0,attributes:!0}):(n[l]("DOMNodeInserted",G,!0),n[l]("DOMAttrModified",G,!0),setInterval(G,999)),r("hashchange",G,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){i[l](e,G,!0)}),/d$|^c/.test(i.readyState)?oe():(r("load",oe),i[l]("DOMContentLoaded",G),c(oe,2e4)),e.length?(U(),A._lsFlush()):G()},checkElems:G,unveil:ie}}(),P=function(){var e,t=B(function(e,t,i,o){var n,s,a;if(e._lazysizesWidth=o,o+="px",e.setAttribute("sizes",o),g.test(t.nodeName||""))for(n=t.getElementsByTagName("source"),s=0,a=n.length;s<a;s++)n[s].setAttribute("sizes",o);i.detail.dataAttr||z(e,i.detail)}),n=function(e,i,o){var n,s=e.parentNode;s&&(o=w(e,s,o),n=y(e,"lazybeforesizes",{width:o,dataAttr:!!i}),n.defaultPrevented||(o=n.detail.width)&&o!==e._lazysizesWidth&&t(e,s,n,o))},s=function(){var t,i=e.length;if(i)for(t=0;t<i;t++)n(e[t])},a=E(s);return{_:function(){e=i.getElementsByClassName(o.autosizesClass),r("resize",a)},checkElems:a,updateElem:n}}(),D=function(){D.i||(D.i=!0,P._(),N._())};return function(){var e,i={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2};o=t.lazySizesConfig||t.lazysizesConfig||{};for(e in i)e in o||(o[e]=i[e]);t.lazySizesConfig=o,c(function(){o.init&&D()})}(),{cfg:o,autoSizer:P,loader:N,init:D,uP:z,aC:b,rC:C,hC:p,fire:y,gW:w,rAF:A}}});
//# sourceMappingURL=./slidebox-min.js.map